## PopupGuard - 弹窗来源识别与一键治理（Windows）

### 功能
- 实时识别屏幕弹窗来源：进程、签名/发布者、路径、父进程、窗口标题
- 一键操作：关闭窗口、强制结束（支持提权）、屏蔽同源弹窗、打开文件位置
- 规则与白名单：支持自定义屏蔽规则，内置系统进程/可信厂商白名单
- 事件列表：过滤、着色（可信/不可信）、图标与软件名、CSV 导出
- 取窗工具：十字准星拖拽、实时绿色框、滚轮切换候选（紫色）、左键选择右键取消
- 托盘与自启动：最小化到托盘，支持随系统启动
- 性能与可配：事件节流、UI 批量刷新、图标缓存、最大行数；提供性能预设（高性能/均衡/细节/自定义）
- 本地化：默认简体中文

### 截图
- 见 `docs/` 与仓库首页 GIF（可后续补充）。

### 运行环境
- Windows 10/11 x64
- .NET 8 SDK
- Visual Studio 2022 或 Rider（可选）

### 构建与运行
```powershell
# 1. 还原与构建
 dotnet restore
 dotnet build .\PopupGuard.sln -c Release

# 2. 运行（调试）
 dotnet run --project .\src\App\App.csproj -c Debug
```

### 主要子项目
- `src/Core`：事件监听（WinEventHook + 守护轮询）、进程/窗口解析、规则/白名单、签名查询
- `src/App`：WPF UI、系统托盘、取窗工具、设置与规则管理
- `docs/`：产品/技术/测试等文档

### 使用说明
- 主界面实时刷新弹窗来源，可右键或按钮执行：关闭/强杀/屏蔽/打开位置
- 取窗：点击“取窗”→ 鼠标移动有绿色框 → 滚轮切换候选（紫色框锁定）→ 左键选中
- 屏蔽：对选中项点击“屏蔽”，会弹出确认，支持在“规则管理”中撤销
- 导出：支持将当前事件列表导出 CSV

### 设置
- 自启动：是否随系统启动
- 过滤：过滤自身进程、智能过滤（系统/技术性窗口）
- 性能：启用详细信息（WMI）、事件节流间隔、UI 刷新间隔、启用图标缓存、列表最大行数、性能预设

### 权限
- 默认以普通权限运行，需要强制结束受保护进程时会触发 UAC 提权

### 已知问题（进行中）
- 少数宿主/层叠窗口识别偏差（如 UWP ApplicationFrameHost、输入法层）。已加入候选轮换与锁定，持续优化中。

### 路线图
- 更智能的候选生成与窗口归一化
- 规则引擎增强（按签名/公司/父进程/命令行）
- 事件历史与统计面板
- UI/UX 打磨与主题

### 许可证
- 暂定 MIT（可按需调整）。
